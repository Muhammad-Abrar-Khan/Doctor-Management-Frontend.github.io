<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedixPro - Hospital Management System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --secondary: #06B6D4;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --dark: #1F2937;
            --sidebar-width: 250px;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f6f9;
            margin: 0;
            padding: 0;
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: var(--dark);
            color: white;
            padding-top: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
        }
        .sidebar.collapsed {
            transform: translateX(-100%);
        }
        .sidebar-header {
            padding: 0 2rem 2rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--white);
            font-size: 1.3rem;
            font-weight: bold;
        }

        .logo i {
            font-size: 1.7rem;
            color: var(--secondary);
        }
        .nav-item {
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.2s;
            border-left: 3px solid transparent;
        }
        .nav-item:hover, .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: white;
        }
        .nav-item i {
            width: 20px;
            margin-right: 10px;
        }
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 20px;
            min-height: 100vh;
            transition: margin-left 0.3s ease;
        }
        .main-content.expanded {
            margin-left: 0;
        }
        .top-bar {
            background: white;
            padding: 15px 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        .search-bar {
            position: relative;
            flex: 1;
            max-width: 400px;
            margin: 0 20px;
        }
        .search-bar input {
            width: 100%;
            padding: 10px 40px 10px 15px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
        }
        .search-bar i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--secondary-color);
        }
        .notifications {
            position: relative;
        }
        .notifications-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 300px;
            background: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            display: none;
            z-index: 1001;
        }
        .notifications-dropdown.show {
            display: block;
        }
        .notification-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }
        .notification-item:hover {
            background: var(--light-color);
        }
        .notification-item:last-child {
            border-bottom: none;
        }
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .card-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        .card h4 {
            margin: 0 0 5px;
            color: var(--dark-color);
        }
        .card-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        .card-change {
            font-size: 0.9rem;
            color: var(--success-color);
        }
        .card-change.negative {
            color: var(--danger-color);
        }
        .table-responsive {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .table {
            margin: 0;
        }
        .table th {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px;
        }
        .table td {
            padding: 12px 15px;
            border-color: #eee;
        }
        .btn {
            border-radius: 6px;
            padding: 8px 16px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn-primary {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }
        .btn-success {
            background: var(--success-color);
            border-color: var(--success-color);
        }
        .btn-danger {
            background: var(--danger-color);
            border-color: var(--danger-color);
        }
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .modal-content {
            border-radius: 12px;
            border: none;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .modal-header {
            background: linear-gradient(135deg, var(--primary-color), #0056b3);
            color: white;
            border-radius: 12px 12px 0 0;
        }
        .form-label {
            font-weight: 500;
            color: var(--dark-color);
        }
        .form-control, .form-select {
            border-radius: 6px;
            border: 1px solid #ddd;
            padding: 10px;
            transition: border-color 0.2s;
        }
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.25);
        }
        .stepper {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .step {
            flex: 0;
            text-align: center;
            padding: 0;
            background: var(--light-color);
            border-radius: 50%;
            position: relative;
            width: 32px;
            height: 32px;
            line-height: 32px;
            font-size: 1rem;
        }
        .step.active {
            background: var(--primary-color);
            color: white;
        }
        .step.completed {
            background: var(--success-color);
            color: white;
        }
        .step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 100%;
            width: calc(100% - 32px);
            height: 2px;
            background: #ddd;
            z-index: -1;
        }
        .step.active:not(:last-child)::after,
        .step.completed:not(:last-child)::after {
            background: var(--primary-color);
        }
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        .health-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .health-metric {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .hidden {
            display: none !important;
        }
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.show {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .top-bar {
                flex-direction: column;
                gap: 10px;
            }
            .search-bar {
                max-width: none;
                margin: 0;
            }
        }
        .toggle-sidebar {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--primary-color);
            cursor: pointer;
        }
        @media (max-width: 768px) {
            .toggle-sidebar {
                display: block;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-hospital"></i>
                    <span>MedixPro</span>
                </div>
            </div>
        <div class="nav-items">
            <div class="nav-item active" data-section="admin-dashboard">
                <i class="fas fa-tachometer-alt"></i> Admin Dashboard
            </div>
            <div class="nav-item" data-section="doctor-dashboard">
                <i class="fas fa-user-md"></i> Doctor Dashboard
            </div>
            <div class="nav-item" data-section="patient-dashboard">
                <i class="fas fa-user"></i> Patient Dashboard
            </div>
            <div class="nav-item" data-section="doctors">
                <i class="fas fa-users"></i> Doctors
            </div>
            <div class="nav-item" data-section="patients">
                <i class="fas fa-user-injured"></i> Patients
            </div>
            <div class="nav-item" data-section="appointments">
                <i class="fas fa-calendar-check"></i> Appointments
            </div>
            <div class="nav-item" data-section="prescriptions">
                <i class="fas fa-prescription-bottle-alt"></i> Prescriptions
            </div>
            <div class="nav-item" data-section="ambulance">
                <i class="fas fa-ambulance"></i> Ambulance
            </div>
            <div class="nav-item" data-section="pharmacy">
                <i class="fas fa-pills"></i> Pharmacy
            </div>
            <div class="nav-item" data-section="blood-bank">
                <i class="fas fa-tint"></i> Blood Bank
            </div>
            <div class="nav-item" data-section="billing">
                <i class="fas fa-dollar-sign"></i> Billing
            </div>
            <div class="nav-item" data-section="departments">
                <i class="fas fa-building"></i> Departments
            </div>
            <div class="nav-item" data-section="inventory">
                <i class="fas fa-boxes"></i> Inventory
            </div>
            <div class="nav-item" data-section="staff">
                <i class="fas fa-user-tie"></i> Staff
            </div>
            <div class="nav-item" data-section="telehealth">
                <i class="fas fa-video"></i> Telehealth
            </div>
            <div class="nav-item" data-section="documents">
                <i class="fas fa-file-medical"></i> Documents
            </div>
            <div class="nav-item" data-section="reports">
                <i class="fas fa-chart-bar"></i> Reports
            </div>
            <div class="nav-item" data-section="settings">
                <i class="fas fa-cog"></i> Settings
            </div>
        </div>
    </div>

    <!-- Toggle Sidebar Button for Mobile -->
    <button class="toggle-sidebar" id="toggleSidebar">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Top Bar -->
        <div class="top-bar">
            <div style="display: flex; align-items: center; gap: 10px;">
                <h4 id="welcomeMessage">Welcome back!</h4>
            </div>
            <div class="search-bar">
                <input type="text" id="globalSearch" placeholder="Search...">
                <i class="fas fa-search"></i>
            </div>
            <div class="notifications">
                <i class="fas fa-bell" style="font-size: 1rem; cursor: pointer;" id="notificationBell"></i>
                <span class="badge bg-danger rounded-pill" id="notificationCount" style="position: absolute; top: -5px; right: -5px; font-size: 0.7rem;">3</span>
                <div class="notifications-dropdown" id="notificationsDropdown">
                    <!-- Notifications will be populated by JS -->
                </div>
            </div>
        </div>

        <!-- Content Sections -->
        <!-- Admin Dashboard -->
        <section id="admin-dashboard" class="content-section">
            <h2>Admin Dashboard</h2>
            <div class="dashboard-cards">
                <div class="card">
                    <i class="fas fa-dollar-sign card-icon text-primary"></i>
                    <h4>Total Revenue</h4>
                    <div class="card-value">$52,456.23</div>
                    <div class="card-change">+15.2% from last month</div>
                </div>
                <div class="card">
                    <i class="fas fa-calendar-check card-icon text-success"></i>
                    <h4>Appointments</h4>
                    <div class="card-value">2,850</div>
                    <div class="card-change">+12.3% from last month</div>
                </div>
                <div class="card">
                    <i class="fas fa-user card-icon text-info"></i>
                    <h4>Patients</h4>
                    <div class="card-value">14,567</div>
                    <div class="card-change">+22.1% from last month</div>
                </div>
                <div class="card">
                    <i class="fas fa-user-tie card-icon text-warning"></i>
                    <h4>Staff</h4>
                    <div class="card-value">612</div>
                    <div class="card-change">+6 new this month</div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Recent Appointments</h5>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Patient</th>
                                        <th>Type</th>
                                        <th>Time</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="recentAppointments">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Patient Visits - Last 7 Days</h5>
                        <canvas id="visitsChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Analytics</h5>
                        <p><strong>No-Show Rate:</strong> 4.2% <span class="text-success">(-0.8% from last month)</span></p>
                        <p><strong>Average Wait Time:</strong> 12 min <span class="text-success">(-4 min from last month)</span></p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Reports</h5>
                        <select id="reportType" class="form-select mb-2">
                            <option>Monthly Revenue</option>
                            <option>Patient Demographics</option>
                            <option>Appointment Statistics</option>
                            <option>Staff Performance</option>
                            <option>Inventory Trends</option>
                        </select>
                        <div class="row mb-2">
                            <div class="col">
                                <input type="date" id="reportStart" class="form-control">
                            </div>
                            <div class="col">
                                <input type="date" id="reportEnd" class="form-control">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="generateReport()">Generate Report</button>
                        <div class="table-responsive mt-3">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Report</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="reportsTable">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Doctor Dashboard -->
        <section id="doctor-dashboard" class="content-section hidden">
            <h2>Doctor Dashboard</h2>
            <div class="dashboard-cards">
                <div class="card">
                    <i class="fas fa-calendar-check card-icon text-primary"></i>
                    <h4>Appointments</h4>
                    <div class="card-value">15</div>
                    <div class="card-change">4 urgent</div>
                    <button class="btn btn-sm btn-primary mt-2">View Schedule</button>
                </div>
                <div class="card">
                    <i class="fas fa-file-medical card-icon text-success"></i>
                    <h4>Pending Reports</h4>
                    <div class="card-value">9</div>
                    <div class="card-change">3 ready</div>
                    <button class="btn btn-sm btn-success mt-2">Review Reports</button>
                </div>
                <div class="card">
                    <i class="fas fa-users card-icon text-info"></i>
                    <h4>Active Patients</h4>
                    <div class="card-value">156</div>
                    <div class="card-change">10 new</div>
                    <button class="btn btn-sm btn-info mt-2">Patient Records</button>
                </div>
                <div class="card">
                    <i class="fas fa-tasks card-icon text-warning"></i>
                    <h4>Pending Tasks</h4>
                    <div class="card-value">7</div>
                    <div class="card-change">3 high priority</div>
                    <button class="btn btn-sm btn-warning mt-2">View Tasks</button>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Today's Schedule</h5>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Patient</th>
                                        <th>Time</th>
                                        <th>Duration</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody id="todaySchedule">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Upcoming Appointments</h5>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Patient</th>
                                        <th>Date & Time</th>
                                        <th>Status</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody id="upcomingAppointments">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Patient Dashboard -->
        <section id="patient-dashboard" class="content-section hidden">
            <h2>Patient Dashboard</h2>
            <div class="dashboard-cards">
                <div class="card">
                    <i class="fas fa-calendar-check card-icon text-primary"></i>
                    <h4>Next Appointment</h4>
                    <div class="card-value">Tomorrow 10:30 AM with Dr. Johnson</div>
                    <button class="btn btn-sm btn-primary mt-2">View Details</button>
                </div>
                <div class="card">
                    <i class="fas fa-pills card-icon text-success"></i>
                    <h4>Medications</h4>
                    <div class="card-value">3 Active</div>
                    <div class="card-change">Next dose in 1 hour</div>
                    <button class="btn btn-sm btn-success mt-2">View All</button>
                </div>
                <div class="card">
                    <i class="fas fa-vial card-icon text-info"></i>
                    <h4>Test Results</h4>
                    <div class="card-value">3 New</div>
                    <div class="card-change">Blood work from 09/05</div>
                    <button class="btn btn-sm btn-info mt-2">View Results</button>
                </div>
                <div class="card">
                    <i class="fas fa-credit-card card-icon text-warning"></i>
                    <h4>Billing</h4>
                    <div class="card-value">$75.00</div>
                    <div class="card-change">Due in 10 days</div>
                    <button class="btn btn-sm btn-warning mt-2">Make Payment</button>
                </div>
            </div>
            <div class="health-summary">
                <div class="health-metric">
                    <h5>Heart Rate</h5>
                    <div class="card-value">74 BPM</div>
                </div>
                <div class="health-metric">
                    <h5>Weight</h5>
                    <div class="card-value">70 kg</div>
                </div>
                <div class="health-metric">
                    <h5>Blood Pressure</h5>
                    <div class="card-value">120/80</div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Medication Reminders</h5>
                        <ul class="list-unstyled" id="medicationReminders">
                            <!-- Populated by JS -->
                        </ul>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Health Tips</h5>
                        <ul class="list-unstyled">
                            <li>Heart Health: Aim for 30 minutes of exercise daily.</li>
                            <li>Stress Management: Practice mindfulness for 10 minutes.</li>
                            <li>Nutrition: Eat more fruits and vegetables.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Doctors Management -->
        <section id="doctors" class="content-section hidden">
            <h2>Doctors Management</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addDoctorModal">Add Doctor</button>
            <div class="row mb-3">
                <div class="col">
                    <input type="text" class="form-control" id="doctorSearch" placeholder="Search Doctors...">
                </div>
                <div class="col-auto">
                    <select id="doctorStatus" class="form-select">
                        <option>All</option>
                        <option>Active</option>
                        <option>Inactive</option>
                    </select>
                </div>
                <div class="col-auto">
                    <input type="date" id="doctorDateFrom" class="form-control">
                </div>
                <div class="col-auto">
                    <input type="date" id="doctorDateTo" class="form-control">
                </div>
                <div class="col-auto">
                    <button class="btn btn-secondary" onclick="filterDoctors()">Apply Filters</button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Specialty</th>
                            <th>Status</th>
                            <th>Patients</th>
                            <th>Experience</th>
                            <th>Contact</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="doctorsTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Patients Management -->
        <section id="patients" class="content-section hidden">
            <h2>Patients Management</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addPatientModal">Add Patient</button>
            <div class="row mb-3">
                <div class="col">
                    <input type="text" class="form-control" id="patientSearch" placeholder="Search Patients...">
                </div>
                <div class="col-auto">
                    <select id="patientStatus" class="form-select">
                        <option>All</option>
                        <option>Active</option>
                        <option>Inactive</option>
                    </select>
                </div>
                <div class="col-auto">
                    <input type="date" id="patientDateFrom" class="form-control">
                </div>
                <div class="col-auto">
                    <input type="date" id="patientDateTo" class="form-control">
                </div>
                <div class="col-auto">
                    <button class="btn btn-secondary" onclick="filterPatients()">Apply Filters</button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Age/Gender</th>
                            <th>Status</th>
                            <th>Last Visit</th>
                            <th>Condition</th>
                            <th>Doctor</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="patientsTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Appointments -->
        <section id="appointments" class="content-section hidden">
            <h2>Appointments</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#scheduleAppointmentModal">New Appointment</button>
            <div class="row mb-3">
                <div class="col">
                    <input type="text" class="form-control" id="appointmentSearch" placeholder="Search Appointments...">
                </div>
                <div class="col-auto">
                    <input type="date" id="appointmentDateFrom" class="form-control">
                </div>
                <div class="col-auto">
                    <input type="date" id="appointmentDateTo" class="form-control">
                </div>
                <div class="col-auto">
                    <button class="btn btn-secondary" onclick="filterAppointments()">Apply Filters</button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Patient</th>
                            <th>Doctor</th>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Duration</th>
                            <th>Type</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="appointmentsTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Prescriptions -->
        <section id="prescriptions" class="content-section hidden">
            <h2>Prescriptions</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addPrescriptionModal">New Prescription</button>
            <div class="row mb-3">
                <div class="col">
                    <input type="text" class="form-control" id="prescriptionSearch" placeholder="Search Prescriptions...">
                </div>
                <div class="col-auto">
                    <button class="btn btn-secondary" onclick="filterPrescriptions()">Search</button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Patient</th>
                            <th>Medication</th>
                            <th>Dosage</th>
                            <th>Frequency</th>
                            <th>Start Date</th>
                            <th>End Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="prescriptionsTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Ambulance -->
        <section id="ambulance" class="content-section hidden">
            <h2>Ambulance Services</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#newAmbulanceModal">New Request</button>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Request ID</th>
                            <th>Patient</th>
                            <th>Location</th>
                            <th>Status</th>
                            <th>Time</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ambulanceTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Pharmacy -->
        <section id="pharmacy" class="content-section hidden">
            <h2>Pharmacy</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addPharmacyItemModal">Add Item</button>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Medication</th>
                            <th>Stock</th>
                            <th>Expiry</th>
                            <th>Price</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="pharmacyTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Blood Bank -->
        <section id="blood-bank" class="content-section hidden">
            <h2>Blood Bank</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addBloodEntryModal">Add Entry</button>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Blood Type</th>
                            <th>Quantity</th>
                            <th>Donor</th>
                            <th>Expiry</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="bloodBankTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Billing -->
        <section id="billing" class="content-section hidden">
            <h2>Billing & Invoices</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#newInvoiceModal">New Invoice</button>
            <div class="dashboard-cards">
                <div class="card">
                    <i class="fas fa-dollar-sign card-icon text-primary"></i>
                    <h4>Total Revenue</h4>
                    <div class="card-value">$152,780</div>
                </div>
                <div class="card">
                    <i class="fas fa-clock card-icon text-warning"></i>
                    <h4>Pending Payments</h4>
                    <div class="card-value">$9,450</div>
                </div>
                <div class="card">
                    <i class="fas fa-exclamation-triangle card-icon text-danger"></i>
                    <h4>Overdue</h4>
                    <div class="card-value">$3,200</div>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Invoice ID</th>
                            <th>Patient</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="billingTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Departments -->
        <section id="departments" class="content-section hidden">
            <h2>Departments</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addDepartmentModal">Add Department</button>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Department</th>
                            <th>Head</th>
                            <th>Staff Count</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="departmentsTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Inventory -->
        <section id="inventory" class="content-section hidden">
            <h2>Inventory Management</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addInventoryItemModal">Add Item</button>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Quantity</th>
                            <th>Supplier</th>
                            <th>Expiry</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="inventoryTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Staff -->
        <section id="staff" class="content-section hidden">
            <h2>Staff Management</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addStaffModal">Add Staff</button>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Role</th>
                            <th>Department</th>
                            <th>Status</th>
                            <th>Contact</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="staffTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Telehealth -->
        <section id="telehealth" class="content-section hidden">
            <h2>Telehealth</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#scheduleSessionModal">Schedule Session</button>
            <div class="row text-center">
                <div class="col-md-4">
                    <div class="card p-4">
                        <i class="fas fa-video fa-3x text-primary mb-3"></i>
                        <h5>Connect to Video Call</h5>
                        <button class="btn btn-primary mt-2">Join Call</button>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-4">
                        <i class="fas fa-comments fa-3x text-success mb-3"></i>
                        <h5>Secure Chat</h5>
                        <button class="btn btn-success mt-2">Start Chat</button>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-4">
                        <i class="fas fa-share fa-3x text-info mb-3"></i>
                        <h5>Share Document</h5>
                        <button class="btn btn-info mt-2">Upload</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Documents -->
        <section id="documents" class="content-section hidden">
            <h2>Documents</h2>
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#uploadDocumentModal">Upload & OCR</button>
            <div class="text-center mb-4">
                <button class="btn btn-outline-secondary" onclick="simulateOCR()">Simulate OCR</button>
            </div>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Document Name</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="documentsTable">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Reports -->
        <section id="reports" class="content-section hidden">
            <h2>Reports & Analytics</h2>
            <div class="chart-container">
                <h5>Generate Report</h5>
                <select id="analyticsReportType" class="form-select mb-2">
                    <option>Patient Summary</option>
                    <option>Revenue Report</option>
                    <option>Appointment Analytics</option>
                    <option>Appointment Statistics</option>
                    <option>Inventory Status</option>
                </select>
                <div class="row mb-2">
                    <div class="col">
                        <input type="date" id="analyticsStart" class="form-control">
                    </div>
                    <div class="col">
                        <input type="date" id="analyticsEnd" class="form-control">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="generateAnalyticsReport()">Generate Report</button>
                <canvas id="analyticsChart" height="300" class="mt-4"></canvas>
            </div>
        </section>

        <!-- Settings -->
        <section id="settings" class="content-section hidden">
            <h2>Settings</h2>
            <div class="row">
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>Profile Settings</h5>
                        <form id="profileForm">
                            <div class="mb-3">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-control" value="Dr. Johnson">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" value="dr.johnson@medixpro.com">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-control" value="+1 (555) 123-4567">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Role</label>
                                <select class="form-select">
                                    <option>Admin</option>
                                    <option>Doctor</option>
                                    <option>Staff</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </form>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="chart-container">
                        <h5>User Profile</h5>
                        <p id="profileName"><strong>Name:</strong> Dr. Johnson</p>
                        <p id="profileEmail"><strong>Email:</strong> dr.johnson@medixpro.com</p>
                        <p id="profileRole"><strong>Role:</strong> Admin</p>
                        <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#editProfileModal">Edit Profile</button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Modals -->
    <!-- Add Doctor Modal (Multi-step) -->
    <div class="modal fade" id="addDoctorModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Doctor</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="stepper" id="doctorStepper">
                        <div class="step active">1</div>
                        <div class="step">2</div>
                        <div class="step">3</div>
                    </div>
                    <form id="addDoctorForm">
                        <!-- Step 1: Personal Information -->
                        <div class="step-content active" data-step="1">
                            <div class="mb-3">
                                <label class="form-label">First Name</label>
                                <input type="text" class="form-control" required name="firstName">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Last Name</label>
                                <input type="text" class="form-control" required name="lastName">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Date of Birth</label>
                                <input type="date" class="form-control" required name="dob">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Gender</label>
                                <select class="form-select" required name="gender">
                                    <option>Male</option>
                                    <option>Female</option>
                                    <option>Other</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Address</label>
                                <input type="text" class="form-control" required name="address">
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">City</label>
                                    <input type="text" class="form-control" required name="city">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">State</label>
                                    <input type="text" class="form-control" required name="state">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Zip Code</label>
                                    <input type="text" class="form-control" required name="zip">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" required name="email">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Phone Number</label>
                                <input type="tel" class="form-control" required name="phone">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Emergency Contact Name</label>
                                <input type="text" class="form-control" name="emergencyName">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Emergency Contact Phone</label>
                                <input type="tel" class="form-control" name="emergencyPhone">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Profile Photo</label>
                                <input type="file" class="form-control" accept="image/*" name="photo">
                            </div>
                        </div>
                        <!-- Step 2: Professional Details -->
                        <div class="step-content hidden" data-step="2">
                            <div class="mb-3">
                                <label class="form-label">Primary Specialization</label>
                                <select class="form-select" required name="specialty">
                                    <option>Cardiology</option>
                                    <option>Neurology</option>
                                    <option>Pediatrics</option>
                                    <option>Orthopedics</option>
                                    <option>Dermatology</option>
                                    <option>Psychiatry</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Secondary Specialization (Optional)</label>
                                <select class="form-select" name="secondarySpecialty">
                                    <option>None</option>
                                    <option>Cardiology</option>
                                    <option>Neurology</option>
                                    <option>Pediatrics</option>
                                    <option>Orthopedics</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Medical License Number</label>
                                <input type="text" class="form-control" required name="licenseNumber">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">License Expiry Date</label>
                                <input type="date" class="form-control" required name="licenseExpiry">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Qualifications</label>
                                <textarea class="form-control" rows="3" name="qualifications"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Education & Training</label>
                                <textarea class="form-control" rows="3" name="education"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Certifications</label>
                                <textarea class="form-control" rows="3" name="certifications"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Department</label>
                                <select class="form-control" required name="department">
                                    <option>Internal Medicine</option>
                                    <option>Neuroscience</option>
                                    <option>Child Health</option>
                                    <option>Surgery</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Position</label>
                                <select class="form-select" required name="position">
                                    <option>Senior Doctor</option>
                                    <option>Junior Doctor</option>
                                    <option>Consultant</option>
                                    <option>Resident</option>
                                </select>
                            </div>
                        </div>
                        <!-- Step 3: Account Settings -->
                        <div class="step-content hidden" data-step="3">
                            <div class="mb-3">
                                <label class="form-label">Username</label>
                                <input type="text" class="form-control" required name="username">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Temporary Password</label>
                                <input type="password" class="form-control" required name="password">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Email Address</label>
                                <input type="email" class="form-control" required name="emailAccount">
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="patientRecords" name="patientRecords">
                                <label class="form-check-label" for="patientRecords">Patient Records - Allow access</label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="prescriptionsAccess" checked name="prescriptionsAccess">
                                <label class="form-check-label" for="prescriptionsAccess">Prescriptions - Allow creating and managing</label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="billingAccess" name="billingAccess">
                                <label class="form-check-label" for="billingAccess">Billing - Allow access</label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="reportsAccess" checked name="reportsAccess">
                                <label class="form-check-label" for="reportsAccess">Reports - Allow access</label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="mfaEnabled" name="mfaEnabled">
                                <label class="form-check-label" for="mfaEnabled">MFA Enabled</label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="appointmentNotifications" checked name="appointmentNotifications">
                                <label class="form-check-label" for="appointmentNotifications">Appointment Notifications</label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="patientUpdates" checked name="patientUpdates">
                                <label class="form-check-label" for="patientUpdates">Patient Updates</label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="systemNotifications" checked name="systemNotifications">
                                <label class="form-check-label" for="systemNotifications">System Notifications</label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="prevStep">Previous</button>
                    <button type="button" class="btn btn-primary" id="nextStep">Next</button>
                    <button type="button" class="btn btn-success" id="saveDoctor" style="display: none;">Save Doctor</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Patient Modal -->
    <div class="modal fade" id="addPatientModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Patient</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="stepper">
                        <div class="step active">1</div>
                        <div class="step">2</div>
                    </div>
                    <form id="addPatientForm">
                        <!-- Step 1: Personal Information -->
                        <div class="step-content active" data-step="1">
                            <div class="mb-3">
                                <label class="form-label">First Name</label>
                                <input type="text" class="form-control" required name="firstName">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Last Name</label>
                                <input type="text" class="form-control" required name="lastName">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Date of Birth</label>
                                <input type="date" class="form-control" required name="dob">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Gender</label>
                                <select class="form-select" required name="gender">
                                    <option>Male</option>
                                    <option>Female</option>
                                    <option>Other</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" name="email">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-control" name="phone">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Address</label>
                                <textarea class="form-control" rows="2" name="address"></textarea>
                            </div>
                        </div>
                        <!-- Step 2: Medical Details -->
                        <div class="step-content hidden" data-step="2">
                            <div class="mb-3">
                                <label class="form-label">Assigned Doctor</label>
                                <select class="form-select" required name="doctor">
                                    <option>Dr. Johnson</option>
                                    <option>Dr. Sarah</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Allergies</label>
                                <textarea class="form-control" rows="2" name="allergies"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Medical History</label>
                                <textarea class="form-control" rows="3" name="medicalHistory"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Problem (SNOMED CT)</label>
                                <select class="form-select" multiple name="problem">
                                    <option>44054006 (Diabetes)</option>
                                    <option>73211009 (Hypertension)</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Diagnosis (ICD-10)</label>
                                <select class="form-select" multiple name="diagnosis">
                                    <option>E11.9 (Type 2 diabetes)</option>
                                    <option>I10 (Hypertension)</option>
                                </select>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="dataSharingConsent" checked name="dataSharingConsent">
                                <label class="form-check-label" for="dataSharingConsent">Consent for Data Sharing</label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="patientPrev">Previous</button>
                    <button type="button" class="btn btn-primary" id="patientNext">Next</button>
                    <button type="button" class="btn btn-success" id="savePatient" style="display: none;">Save Patient</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Appointment Modal -->
    <div class="modal fade" id="scheduleAppointmentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Schedule Appointment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="scheduleForm">
                        <div class="mb-3">
                            <label class="form-label">Patient</label>
                            <select class="form-select" required name="patient">
                                <option>John Smith</option>
                                <option>Emily Davis</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Doctor</label>
                            <select class="form-select" required name="doctor">
                                <option>Dr. Johnson</option>
                                <option>Dr. Sarah</option>
                            </select>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">Date</label>
                                <input type="date" class="form-control" required name="date">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Time</label>
                                <input type="time" class="form-control" required name="time">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Duration</label>
                            <select class="form-select" required name="duration">
                                <option>15 minutes</option>
                                <option>30 minutes</option>
                                <option>45 minutes</option>
                                <option>60 minutes</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Type</label>
                            <select class="form-select" required name="type">
                                <option>Check-up</option>
                                <option>Consultation</option>
                                <option>Follow-up</option>
                                <option>Surgery</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Notes</label>
                            <textarea class="form-control" rows="3" name="notes"></textarea>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="telehealth" name="telehealth">
                            <label class="form-check-label" for="telehealth">Telehealth Appointment</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveAppointment()">Save Appointment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Prescription Modal -->
    <div class="modal fade" id="addPrescriptionModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Prescription</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="prescriptionForm">
                        <div class="mb-3">
                            <label class="form-label">Patient</label>
                            <select class="form-select" required name="patient">
                                <option>John Smith</option>
                                <option>Emily Davis</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Medication</label>
                            <input type="text" class="form-control" required name="medication">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Dosage</label>
                            <input type="text" class="form-control" required name="dosage">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Frequency</label>
                            <input type="text" class="form-control" required name="frequency">
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">Start Date</label>
                                <input type="date" class="form-control" required name="start">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">End Date</label>
                                <input type="date" class="form-control" required name="end">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="savePrescription()">Save Prescription</button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Ambulance Request Modal -->
    <div class="modal fade" id="newAmbulanceModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">New Ambulance Request</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="ambulanceForm">
                        <div class="mb-3">
                            <label class="form-label">Patient</label>
                            <select class="form-select" required name="patient">
                                <option>John Smith</option>
                                <option>Emily Davis</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Location</label>
                            <input type="text" class="form-control" required name="location">
                        </div>
                        <!-- Additional fields can be added -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveAmbulanceRequest()">Save Request</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Pharmacy Item Modal -->
    <div class="modal fade" id="addPharmacyItemModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Pharmacy Item</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="pharmacyForm">
                        <div class="mb-3">
                            <label class="form-label">Medication</label>
                            <input type="text" class="form-control" required name="medication">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Stock</label>
                            <input type="number" class="form-control" required name="stock">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Expiry</label>
                            <input type="date" class="form-control" required name="expiry">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Price</label>
                            <input type="number" step="0.01" class="form-control" required name="price">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="savePharmacyItem()">Save Item</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Blood Bank Entry Modal -->
    <div class="modal fade" id="addBloodEntryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Blood Bank Entry</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="bloodForm">
                        <div class="mb-3">
                            <label class="form-label">Blood Type</label>
                            <select class="form-select" required name="type">
                                <option>O+</option>
                                <option>A-</option>
                                <option>A+</option>
                                <option>B-</option>
                                <option>B+</option>
                                <option>AB-</option>
                                <option>AB+</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Quantity</label>
                            <input type="number" class="form-control" required name="quantity">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Donor</label>
                            <input type="text" class="form-control" required name="donor">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Expiry</label>
                            <input type="date" class="form-control" required name="expiry">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveBloodEntry()">Save Entry</button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Invoice Modal -->
    <div class="modal fade" id="newInvoiceModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">New Invoice</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="invoiceForm">
                        <div class="mb-3">
                            <label class="form-label">Patient</label>
                            <select class="form-select" required name="patient">
                                <option>John Smith</option>
                                <option>Emily Davis</option>
                            </select>
                        </div>
                        <!-- Additional fields for amount, items, etc. -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveInvoice()">Create Invoice</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Department Modal -->
    <div class="modal fade" id="addDepartmentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Department</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="departmentForm">
                        <div class="mb-3">
                            <label class="form-label">Department</label>
                            <input type="text" class="form-control" required name="department">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Head</label>
                            <select class="form-select" required name="head">
                                <option>Dr. Johnson</option>
                                <option>Dr. Sarah</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveDepartment()">Save Department</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Inventory Item Modal -->
    <div class="modal fade" id="addInventoryItemModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Inventory Item</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="inventoryForm">
                        <div class="mb-3">
                            <label class="form-label">Item</label>
                            <input type="text" class="form-control" required name="item">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Quantity</label>
                            <input type="number" class="form-control" required name="quantity">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Supplier</label>
                            <input type="text" class="form-control" required name="supplier">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Expiry</label>
                            <input type="date" class="form-control" name="expiry">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveInventoryItem()">Save Item</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Staff Modal -->
    <div class="modal fade" id="addStaffModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Staff</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="staffForm">
                        <div class="mb-3">
                            <label class="form-label">Name</label>
                            <input type="text" class="form-control" required name="name">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Role</label>
                            <input type="text" class="form-control" required name="role">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Department</label>
                            <select class="form-select" required name="department">
                                <option>Internal Medicine</option>
                                <option>Neuroscience</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Contact</label>
                            <input type="tel" class="form-control" name="contact">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveStaff()">Save Staff</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Session Modal -->
    <div class="modal fade" id="scheduleSessionModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Schedule Telehealth Session</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="sessionForm">
                        <!-- Similar to appointment form, with telehealth focus -->
                        <div class="mb-3">
                            <label class="form-label">Patient</label>
                            <select class="form-select" name="patient"></select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Doctor</label>
                            <select class="form-select" name="doctor"></select>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">Date</label>
                                <input type="date" class="form-control" name="date">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Time</label>
                                <input type="time" class="form-control" name="time">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveSession()">Schedule Session</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Document Modal -->
    <div class="modal fade" id="uploadDocumentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Upload & OCR Document</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="documentForm" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label class="form-label">Document</label>
                            <input type="file" class="form-control" accept=".pdf,.jpg,.png" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Scan/OCR Legacy Paper</label>
                            <input type="file" class="form-control" accept="image/*">
                        </div>
                    </form>
                    <div id="ocrResult" class="mt-3 hidden">
                        <h6>OCR Result:</h6>
                        <textarea class="form-control" rows="5" readonly></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="uploadDocument()">Upload</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal (for Settings) -->
    <div class="modal fade" id="editProfileModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editProfileForm">
                        <div class="mb-3">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" value="Dr. Johnson" name="name">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" value="dr.johnson@medixpro.com" name="email">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Phone</label>
                            <input type="tel" class="form-control" value="+1 (555) 123-4567" name="phone">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Role</label>
                            <select class="form-select" name="role">
                                <option selected>Admin</option>
                                <option>Doctor</option>
                                <option>Staff</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveEditProfile()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

<script>
    // Global variables
let currentUserRole = 'admin';
let currentStep = 1;
let currentPatientStep = 1;
let charts = {};

// Mock data for demonstration
const mockData = {
    recentAppointments: [
        { patient: 'John Smith', type: 'Check-up', time: 'Today 10:00 AM', status: 'Confirmed' },
        { patient: 'Emily Davis', type: 'Consultation', time: 'Today 11:30 AM', status: 'In Progress' },
        { patient: 'Robert Wilson', type: 'Follow-up', time: 'Today 09:15 AM', status: 'Completed' },
        { patient: 'Alice Brown', type: 'Vaccination', time: 'Today 02:00 PM', status: 'Pending' },
        { patient: 'Emma Thompson', type: 'Check-up', time: 'Today 09:00 AM', status: 'Confirmed' }
    ],
    todaySchedule: [
        { patient: 'Emma Thompson', time: '09:00 AM', duration: '30 min', type: 'Check-up' },
        { patient: 'Michael Chen', time: '10:15 AM', duration: '45 min', type: 'Follow-up' },
        { patient: 'Sophia Rodriguez', time: '11:30 AM', duration: '60 min', type: 'Consultation' },
        { patient: 'John Doe', time: '12:00 PM', duration: '30 min', type: 'Check-up' },
        { patient: 'Jane Smith', time: '01:00 PM', duration: '45 min', type: 'Consultation' }
    ],
    upcomingAppointments: [
        { patient: 'John Doe', datetime: '2025-09-13 09:00 AM', status: 'Confirmed', type: 'Follow-up' },
        { patient: 'Jane Smith', datetime: '2025-09-13 10:30 AM', status: 'Pending', type: 'New Patient' },
        { patient: 'Alice Brown', datetime: '2025-09-14 11:00 AM', status: 'Confirmed', type: 'Vaccination' },
        { patient: 'Robert Wilson', datetime: '2025-09-15 02:00 PM', status: 'Pending', type: 'Follow-up' }
    ],
    medicationReminders: [
        'Lisinopril - 10mg  Once daily - 8:00 AM',
        'Metformin - 500mg  Twice daily - 2:00 PM',
        'Aspirin - 81mg  Once daily - 9:00 PM'
    ],
    doctors: [
        { id: 1, name: 'Dr. Johnson', specialty: 'Cardiology', status: 'Active', patients: 45, experience: '10 years', contact: 'johnson@medix.com', phone: '+1-555-0101' },
        { id: 2, name: 'Dr. Sarah Williams', specialty: 'Neurology', status: 'Active', patients: 32, experience: '8 years', contact: 'sarah@medix.com', phone: '+1-555-0102' },
        { id: 3, name: 'Dr. Michael Brown', specialty: 'Pediatrics', status: 'Active', patients: 28, experience: '12 years', contact: 'michael@medix.com', phone: '+1-555-0103' }
    ],
    patients: [
        { id: 1, name: 'John Smith', ageGender: '35/M', status: 'Active', lastVisit: '2025-09-10', condition: 'Hypertension', doctor: 'Dr. Johnson', phone: '+1-555-1001' },
        { id: 2, name: 'Emily Davis', ageGender: '28/F', status: 'Active', lastVisit: '2025-09-05', condition: 'Diabetes', doctor: 'Dr. Sarah Williams', phone: '+1-555-1002' },
        { id: 3, name: 'Robert Wilson', ageGender: '42/M', status: 'Active', lastVisit: '2025-09-08', condition: 'Asthma', doctor: 'Dr. Michael Brown', phone: '+1-555-1003' }
    ],
    appointments: [
        { id: 1, patient: 'John Smith', doctor: 'Dr. Johnson', date: '2025-09-10', time: '10:00', duration: '30 min', type: 'Check-up', status: 'Confirmed' },
        { id: 2, patient: 'Emily Davis', doctor: 'Dr. Sarah Williams', date: '2025-09-11', time: '14:30', duration: '45 min', type: 'Consultation', status: 'Pending' }
    ],
    prescriptions: [
        { id: 1, patient: 'John Smith', medication: 'Lisinopril', dosage: '10mg', frequency: 'Daily', start: '2025-09-01', end: '2025-12-01', status: 'Active' },
        { id: 2, patient: 'Emily Davis', medication: 'Metformin', dosage: '500mg', frequency: 'Twice daily', start: '2025-08-15', end: '2025-11-15', status: 'Active' }
    ],
    ambulance: [
        { id: 'AMB001', patient: 'John Smith', location: '123 Main St, City Center', status: 'Dispatched', time: '2025-09-10 10:00', priority: 'High' },
        { id: 'AMB002', patient: 'Alice Brown', location: '456 Oak Ave, Downtown', status: 'En Route', time: '2025-09-10 11:15', priority: 'Medium' }
    ],
    pharmacy: [
        { id: 1, medication: 'Aspirin', stock: 500, expiry: '2026-01-01', price: 5.99, supplier: 'MedSupply Inc' },
        { id: 2, medication: 'Lisinopril', stock: 150, expiry: '2025-12-15', price: 12.50, supplier: 'PharmaCorp' },
        { id: 3, medication: 'Metformin', stock: 200, expiry: '2026-03-10', price: 8.75, supplier: 'HealthMeds' }
    ],
    bloodBank: [
        { id: 1, type: 'O+', quantity: 10, donor: 'Jane Doe', expiry: '2025-10-10', collected: '2025-09-10' },
        { id: 2, type: 'A-', quantity: 5, donor: 'Mike Johnson', expiry: '2025-10-15', collected: '2025-09-15' },
        { id: 3, type: 'AB+', quantity: 3, donor: 'Sarah Wilson', expiry: '2025-10-20', collected: '2025-09-20' }
    ],
    billing: [
        { id: 'INV001', patient: 'John Smith', amount: 150.00, status: 'Paid', date: '2025-09-10', dueDate: '2025-10-10' },
        { id: 'INV002', patient: 'Emily Davis', amount: 225.50, status: 'Pending', date: '2025-09-08', dueDate: '2025-10-08' },
        { id: 'INV003', patient: 'Robert Wilson', amount: 75.00, status: 'Overdue', date: '2025-08-15', dueDate: '2025-09-15' }
    ],
    departments: [
        { id: 1, department: 'Cardiology', head: 'Dr. Johnson', staff: 15, status: 'Active', budget: 250000 },
        { id: 2, department: 'Neurology', head: 'Dr. Sarah Williams', staff: 12, status: 'Active', budget: 200000 },
        { id: 3, department: 'Pediatrics', head: 'Dr. Michael Brown', staff: 18, status: 'Active', budget: 180000 }
    ],
    inventory: [
        { id: 1, item: 'Syringes', quantity: 1000, supplier: 'MedSupply', expiry: '2026-06-01', reorderLevel: 100 },
        { id: 2, item: 'Surgical Gloves', quantity: 5000, supplier: 'SafeMed', expiry: '2027-01-01', reorderLevel: 500 },
        { id: 3, item: 'Bandages', quantity: 800, supplier: 'HealthCare Plus', expiry: '2026-12-01', reorderLevel: 200 }
    ],
    staff: [
        { id: 1, name: 'Alice Brown', role: 'Nurse', department: 'Cardiology', status: 'Active', contact: 'alice@medix.com', phone: '+1-555-2001' },
        { id: 2, name: 'David Wilson', role: 'Lab Technician', department: 'Laboratory', status: 'Active', contact: 'david@medix.com', phone: '+1-555-2002' },
        { id: 3, name: 'Lisa Garcia', role: 'Receptionist', department: 'Administration', status: 'Active', contact: 'lisa@medix.com', phone: '+1-555-2003' }
    ],
    documents: [
        { id: 1, name: 'Patient Record 001.pdf', date: '2025-09-10', type: 'Medical Record', size: '2.5 MB' },
        { id: 2, name: 'Lab Results - Blood Work.pdf', date: '2025-09-09', type: 'Lab Report', size: '1.8 MB' },
        { id: 3, name: 'X-Ray Results.pdf', date: '2025-09-08', type: 'Imaging', size: '4.2 MB' }
    ],
    reports: [
        { id: 1, report: 'Monthly Revenue - Aug 2025', date: '2025-09-01', status: 'Generated', type: 'Financial' },
        { id: 2, report: 'Patient Demographics - Sep 2025', date: '2025-09-05', status: 'Generated', type: 'Demographics' },
        { id: 3, report: 'Appointment Statistics - Sep 2025', date: '2025-09-07', status: 'Pending', type: 'Analytics' },
        { id: 4, report: 'Inventory Status Report', date: '2025-09-09', status: 'Generated', type: 'Inventory' }
    ],
    notifications: [
        { id: 1, message: 'New Appointment: John Smith scheduled for 10:00 AM', time: '2 hours ago', read: false, priority: 'normal' },
        { id: 2, message: 'Low Inventory: Syringes stock below 100 units', time: '5 hours ago', read: false, priority: 'high' },
        { id: 3, message: 'Payment Received: Emily Davis paid $150', time: '1 day ago', read: true, priority: 'normal' },
        { id: 4, message: 'System Update: New version available', time: '3 days ago', read: true, priority: 'low' }
    ]
};

// Initialize application
document.addEventListener('DOMContentLoaded', function() {
    console.log('MedixPro System Initializing...');
    initializeUserRole();
    setupEventListeners();
    populateAllDashboards();
    initializeCharts();
    setupRealTimeFeatures();
    console.log('MedixPro System Ready');
});

// User Role and Access Control
function initializeUserRole() {
    const welcomeMessage = document.getElementById('welcomeMessage');
    if (welcomeMessage) {
        welcomeMessage.textContent = `Welcome back, ${currentUserRole.charAt(0).toUpperCase() + currentUserRole.slice(1)}!`;
    }
    hideRoleRestrictedSections();
}

function hideRoleRestrictedSections() {
    const navItems = document.querySelectorAll('.nav-item');
    
    if (currentUserRole === 'patient') {
        const allowedSections = ['patient-dashboard'];
        navItems.forEach(item => {
            if (!allowedSections.includes(item.dataset.section)) {
                item.style.display = 'none';
            }
        });
    } else if (currentUserRole === 'doctor') {
        const restrictedSections = ['admin-dashboard', 'billing', 'departments', 'staff'];
        navItems.forEach(item => {
            if (restrictedSections.includes(item.dataset.section)) {
                item.style.display = 'none';
            }
        });
    }
    
    const defaultSection = currentUserRole === 'admin' ? 'admin-dashboard' : 
                          currentUserRole === 'doctor' ? 'doctor-dashboard' : 'patient-dashboard';
    showSection(defaultSection);
}

// Event Listeners Setup
function setupEventListeners() {
    // Navigation
    document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', (e) => {
            e.preventDefault();
            showSection(e.currentTarget.dataset.section);
        });
    });

    // Search functionality
    const globalSearch = document.getElementById('globalSearch');
    if (globalSearch) {
        globalSearch.addEventListener('input', debounce(handleGlobalSearch, 300));
    }

    // Mobile sidebar toggle
    const toggleSidebar = document.getElementById('toggleSidebar');
    if (toggleSidebar) {
        toggleSidebar.addEventListener('click', handleToggleSidebar);
    }

    // Notification handling
    const notificationBell = document.getElementById('notificationBell');
    if (notificationBell) {
        notificationBell.addEventListener('click', toggleNotifications);
    }
    document.addEventListener('click', handleOutsideClick);

    // Multi-step modals
    setupDoctorModal();
    setupPatientModal();

    // Form submissions
    setupFormHandlers();

    // Filter buttons
    setupFilterHandlers();

    // Window resize handler
    window.addEventListener('resize', handleWindowResize);

    // Keyboard shortcuts
    document.addEventListener('keydown', handleKeyboardShortcuts);
}

// Navigation and Section Management
function showSection(sectionId) {
    document.querySelectorAll('.content-section').forEach(section => {
        section.classList.add('hidden');
    });
    
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.classList.remove('hidden');
        
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
        });
        const activeNav = document.querySelector(`[data-section="${sectionId}"]`);
        if (activeNav) {
            activeNav.classList.add('active');
        }
        
        loadSectionData(sectionId);
    }
}

function loadSectionData(sectionId) {
    switch (sectionId) {
        case 'admin-dashboard':
            populateAdminDashboard();
            break;
        case 'doctor-dashboard':
            populateDoctorDashboard();
            break;
        case 'patient-dashboard':
            populatePatientDashboard();
            break;
        case 'doctors':
            populateDoctorsTable();
            break;
        case 'patients':
            populatePatientsTable();
            break;
        case 'appointments':
            populateAppointmentsTable();
            break;
        case 'prescriptions':
            populatePrescriptionsTable();
            break;
        case 'ambulance':
            populateAmbulanceTable();
            break;
        case 'pharmacy':
            populatePharmacyTable();
            break;
        case 'blood-bank':
            populateBloodBankTable();
            break;
        case 'billing':
            populateBillingTable();
            break;
        case 'departments':
            populateDepartmentsTable();
            break;
        case 'inventory':
            populateInventoryTable();
            break;
        case 'staff':
            populateStaffTable();
            break;
        case 'documents':
            populateDocumentsTable();
            break;
        case 'reports':
            populateReportsTable();
            break;
    }
}

// Dashboard Population Functions
function populateAllDashboards() {
    populateAdminDashboard();
    populateDoctorDashboard();
    populatePatientDashboard();
    populateNotifications();
}

function populateAdminDashboard() {
    const tbody = document.getElementById('recentAppointments');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.recentAppointments.forEach(apt => {
        const row = tbody.insertRow();
        const statusClass = getStatusClass(apt.status);
        row.innerHTML = `
            <td>${apt.patient}</td>
            <td>${apt.type}</td>
            <td>${apt.time}</td>
            <td><span class="badge bg-${statusClass}">${apt.status}</span></td>
        `;
    });
    
    const reportsTable = document.getElementById('reportsTable');
    if (reportsTable) {
        reportsTable.innerHTML = mockData.reports.map(report => `
            <tr>
                <td>${report.report}</td>
                <td>${report.date}</td>
                <td><span class="badge bg-${report.status === 'Generated' ? 'success' : 'warning'}">${report.status}</span></td>
                <td>
                    ${report.status === 'Generated' ? 
                        `<button class="btn btn-sm btn-primary" onclick="downloadReport(${report.id})">Download</button>` : 
                        `<button class="btn btn-sm btn-secondary" onclick="viewReportStatus(${report.id})">View Status</button>`
                    }
                </td>
            </tr>
        `).join('');
    }
}

function populateDoctorDashboard() {
    const todaySchedule = document.getElementById('todaySchedule');
    if (todaySchedule) {
        todaySchedule.innerHTML = '';
        mockData.todaySchedule.forEach(schedule => {
            const row = todaySchedule.insertRow();
            row.innerHTML = `
                <td>${schedule.patient}</td>
                <td>${schedule.time}</td>
                <td>${schedule.duration}</td>
                <td>${schedule.type}</td>
            `;
        });
    }
    
    const upcomingAppointments = document.getElementById('upcomingAppointments');
    if (upcomingAppointments) {
        upcomingAppointments.innerHTML = '';
        mockData.upcomingAppointments.forEach(apt => {
            const row = upcomingAppointments.insertRow();
            const statusClass = getStatusClass(apt.status);
            row.innerHTML = `
                <td>${apt.patient}</td>
                <td>${apt.datetime}</td>
                <td><span class="badge bg-${statusClass}">${apt.status}</span></td>
                <td>${apt.type}</td>
            `;
        });
    }
}

function populatePatientDashboard() {
    const medicationReminders = document.getElementById('medicationReminders');
    if (medicationReminders) {
        medicationReminders.innerHTML = '';
        mockData.medicationReminders.forEach(reminder => {
            const li = document.createElement('li');
            li.className = 'list-item mb-2 p-2 border rounded';
            li.innerHTML = `
                <div class="d-flex justify-content-between align-items-center">
                    <span>${reminder}</span>
                    <button class="btn btn-sm btn-outline-primary" onclick="markMedicationTaken(this)">Mark Taken</button>
                </div>
            `;
            medicationReminders.appendChild(li);
        });
    }
}

// Table Population Functions
function populateDoctorsTable() {
    const tbody = document.getElementById('doctorsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.doctors.forEach(doctor => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${doctor.name}</td>
            <td>${doctor.specialty}</td>
            <td><span class="badge bg-${doctor.status === 'Active' ? 'success' : 'secondary'}">${doctor.status}</span></td>
            <td>${doctor.patients}</td>
            <td>${doctor.experience}</td>
            <td>
                <div>${doctor.contact}</div>
                <small class="text-muted">${doctor.phone}</small>
            </td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editDoctor(${doctor.id})">Edit</button>
                <button class="btn btn-sm btn-info me-1" onclick="viewDoctorSchedule(${doctor.id})">Schedule</button>
                <button class="btn btn-sm btn-danger" onclick="deleteDoctor(${doctor.id})">Delete</button>
            </td>
        `;
    });
}

function populatePatientsTable() {
    const tbody = document.getElementById('patientsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.patients.forEach(patient => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${patient.name}</td>
            <td>${patient.ageGender}</td>
            <td><span class="badge bg-${patient.status === 'Active' ? 'success' : 'secondary'}">${patient.status}</span></td>
            <td>${patient.lastVisit}</td>
            <td>${patient.condition}</td>
            <td>${patient.doctor}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editPatient(${patient.id})">Edit</button>
                <button class="btn btn-sm btn-info me-1" onclick="viewPatientHistory(${patient.id})">History</button>
                <button class="btn btn-sm btn-danger" onclick="deletePatient(${patient.id})">Delete</button>
            </td>
        `;
    });
}

function populateAppointmentsTable() {
    const tbody = document.getElementById('appointmentsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.appointments.forEach(apt => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${apt.patient}</td>
            <td>${apt.doctor}</td>
            <td>${apt.date}</td>
            <td>${apt.time}</td>
            <td>${apt.duration}</td>
            <td>${apt.type}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editAppointment(${apt.id})">Edit</button>
                <button class="btn btn-sm btn-success me-1" onclick="confirmAppointment(${apt.id})">Confirm</button>
                <button class="btn btn-sm btn-danger" onclick="cancelAppointment(${apt.id})">Cancel</button>
            </td>
        `;
    });
}

function populatePrescriptionsTable() {
    const tbody = document.getElementById('prescriptionsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.prescriptions.forEach(prescription => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${prescription.patient}</td>
            <td>${prescription.medication}</td>
            <td>${prescription.dosage}</td>
            <td>${prescription.frequency}</td>
            <td>${prescription.start}</td>
            <td>${prescription.end}</td>
            <td><span class="badge bg-success">${prescription.status}</span></td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editPrescription(${prescription.id})">Edit</button>
                <button class="btn btn-sm btn-info me-1" onclick="renewPrescription(${prescription.id})">Renew</button>
                <button class="btn btn-sm btn-secondary" onclick="printPrescription(${prescription.id})">Print</button>
            </td>
        `;
    });
}

function populateAmbulanceTable() {
    const tbody = document.getElementById('ambulanceTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.ambulance.forEach(request => {
        const row = tbody.insertRow();
        const statusClass = request.status === 'Dispatched' ? 'warning' : 
                          request.status === 'En Route' ? 'info' : 'secondary';
        row.innerHTML = `
            <td>${request.id}</td>
            <td>${request.patient}</td>
            <td>${request.location}</td>
            <td><span class="badge bg-${statusClass}">${request.status}</span></td>
            <td>${request.time}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="trackAmbulance('${request.id}')">Track</button>
                <button class="btn btn-sm btn-info me-1" onclick="updateAmbulanceStatus('${request.id}')">Update</button>
                <button class="btn btn-sm btn-danger" onclick="cancelAmbulanceRequest('${request.id}')">Cancel</button>
            </td>
        `;
    });
}

function populatePharmacyTable() {
    const tbody = document.getElementById('pharmacyTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.pharmacy.forEach(item => {
        const row = tbody.insertRow();
        const lowStock = item.stock < 100;
        row.innerHTML = `
            <td>${item.medication}</td>
            <td ${lowStock ? 'class="text-danger fw-bold"' : ''}>${item.stock}</td>
            <td>${item.expiry}</td>
            <td>$${item.price.toFixed(2)}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editPharmacyItem(${item.id})">Edit</button>
                <button class="btn btn-sm btn-success me-1" onclick="restockItem(${item.id})">Restock</button>
                ${lowStock ? '<span class="badge bg-danger">Low Stock</span>' : ''}
            </td>
        `;
    });
}

function populateBloodBankTable() {
    const tbody = document.getElementById('bloodBankTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.bloodBank.forEach(entry => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${entry.type}</td>
            <td>${entry.quantity} units</td>
            <td>${entry.donor}</td>
            <td>${entry.expiry}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editBloodEntry(${entry.id})">Edit</button>
                <button class="btn btn-sm btn-success me-1" onclick="useBlood(${entry.id})">Use</button>
                <button class="btn btn-sm btn-info" onclick="viewBloodDetails(${entry.id})">Details</button>
            </td>
        `;
    });
}

function populateBillingTable() {
    const tbody = document.getElementById('billingTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.billing.forEach(invoice => {
        const row = tbody.insertRow();
        const statusClass = invoice.status === 'Paid' ? 'success' : 
                          invoice.status === 'Pending' ? 'warning' : 'danger';
        row.innerHTML = `
            <td>${invoice.id}</td>
            <td>${invoice.patient}</td>
            <td>$${invoice.amount.toFixed(2)}</td>
            <td><span class="badge bg-${statusClass}">${invoice.status}</span></td>
            <td>${invoice.date}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="viewInvoice('${invoice.id}')">View</button>
                <button class="btn btn-sm btn-info me-1" onclick="printInvoice('${invoice.id}')">Print</button>
                ${invoice.status === 'Pending' ? `<button class="btn btn-sm btn-success" onclick="markPaid('${invoice.id}')">Mark Paid</button>` : ''}
            </td>
        `;
    });
}

function populateDepartmentsTable() {
    const tbody = document.getElementById('departmentsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.departments.forEach(dept => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${dept.department}</td>
            <td>${dept.head}</td>
            <td>${dept.staff}</td>
            <td><span class="badge bg-success">${dept.status}</span></td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editDepartment(${dept.id})">Edit</button>
                <button class="btn btn-sm btn-info me-1" onclick="manageDepartmentStaff(${dept.id})">Staff</button>
                <button class="btn btn-sm btn-secondary" onclick="manageBudget(${dept.id})">Budget</button>
            </td>
        `;
    });
}

function populateInventoryTable() {
    const tbody = document.getElementById('inventoryTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.inventory.forEach(item => {
        const row = tbody.insertRow();
        const lowStock = item.quantity <= item.reorderLevel;
        row.innerHTML = `
            <td>${item.item}</td>
            <td ${lowStock ? 'class="text-danger fw-bold"' : ''}>${item.quantity}</td>
            <td>${item.supplier}</td>
            <td>${item.expiry || 'N/A'}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editInventoryItem(${item.id})">Edit</button>
                <button class="btn btn-sm btn-warning me-1" onclick="orderItem(${item.id})">Order</button>
                ${lowStock ? '<span class="badge bg-danger">Reorder</span>' : ''}
            </td>
        `;
    });
}

function populateStaffTable() {
    const tbody = document.getElementById('staffTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.staff.forEach(staff => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${staff.name}</td>
            <td>${staff.role}</td>
            <td>${staff.department}</td>
            <td><span class="badge bg-${staff.status === 'Active' ? 'success' : 'secondary'}">${staff.status}</span></td>
            <td>
                <div>${staff.contact}</div>
                <small class="text-muted">${staff.phone}</small>
            </td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editStaff(${staff.id})">Edit</button>
                <button class="btn btn-sm btn-info me-1" onclick="viewStaffSchedule(${staff.id})">Schedule</button>
                <button class="btn btn-sm btn-danger" onclick="deleteStaff(${staff.id})">Delete</button>
            </td>
        `;
    });
}

function populateDocumentsTable() {
    const tbody = document.getElementById('documentsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    mockData.documents.forEach(doc => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>
                <div>${doc.name}</div>
                <small class="text-muted">${doc.type} - ${doc.size}</small>
            </td>
            <td>${doc.date}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="viewDocument(${doc.id})">View</button>
                <button class="btn btn-sm btn-info me-1" onclick="downloadDocument(${doc.id})">Download</button>
                <button class="btn btn-sm btn-secondary" onclick="shareDocument(${doc.id})">Share</button>
            </td>
        `;
    });
}

function populateReportsTable() {
    const tbody = document.getElementById('reportsTable');
    if (!tbody) return;
    
    tbody.innerHTML = mockData.reports.map(report => `
        <tr>
            <td>${report.report}</td>
            <td>${report.date}</td>
            <td><span class="badge bg-${report.status === 'Generated' ? 'success' : 'warning'}">${report.status}</span></td>
            <td>
                ${report.status === 'Generated' ? 
                    `<button class="btn btn-sm btn-primary" onclick="downloadReport(${report.id})">Download</button>` : 
                    `<button class="btn btn-sm btn-secondary">Processing...</button>`
                }
            </td>
        </tr>
    `).join('');
}

function populateNotifications() {
    const dropdown = document.getElementById('notificationsDropdown');
    const count = document.getElementById('notificationCount');
    
    if (dropdown) {
        dropdown.innerHTML = '';
        mockData.notifications.forEach(notif => {
            const div = document.createElement('div');
            div.className = 'notification-item';
            div.innerHTML = `
                <strong>${notif.message}</strong><br>
                <small>${notif.time}</small>
                ${!notif.read ? `<button class="btn btn-xs btn-outline-primary ms-1" onclick="markNotificationRead(${notif.id})">Mark Read</button>` : ''}
            `;
            dropdown.appendChild(div);
        });
    }
    
    if (count) {
        const unreadCount = mockData.notifications.filter(n => !n.read).length;
        count.textContent = unreadCount;
        count.style.display = unreadCount > 0 ? 'inline' : 'none';
    }
}

// Utility Functions
function getStatusClass(status) {
    switch (status.toLowerCase()) {
        case 'confirmed':
        case 'active':
        case 'paid':
            return 'success';
        case 'pending':
            return 'warning';
        case 'in progress':
            return 'info';
        case 'completed':
            return 'primary';
        case 'overdue':
        case 'cancelled':
            return 'danger';
        default:
            return 'secondary';
    }
}

function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

function showAlert(message, type) {
    const alertContainer = document.createElement('div');
    alertContainer.className = `alert alert-${type} alert-dismissible fade show`;
    alertContainer.style.position = 'fixed';
    alertContainer.style.top = '20px';
    alertContainer.style.right = '20px';
    alertContainer.style.zIndex = '1050';
    alertContainer.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    document.body.appendChild(alertContainer);
    setTimeout(() => {
        alertContainer.classList.remove('show');
        setTimeout(() => alertContainer.remove(), 150);
    }, 3000);
}

// Search Functionality
function handleGlobalSearch(e) {
    const query = e.target.value.toLowerCase().trim();
    
    if (query.length < 2) {
        clearSearchHighlights();
        return;
    }
    
    const tables = document.querySelectorAll('.content-section table tbody');
    tables.forEach(tbody => {
        const rows = tbody.querySelectorAll('tr');
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            if (text.includes(query)) {
                row.style.display = '';
                highlightSearchTerm(row, query);
            } else {
                row.style.display = 'none';
            }
        });
    });
}

function clearSearchHighlights() {
    const highlights = document.querySelectorAll('.search-highlight');
    highlights.forEach(highlight => {
        const parent = highlight.parentNode;
        parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
        parent.normalize();
    });
    
    document.querySelectorAll('tr').forEach(row => {
        row.style.display = '';
    });
}

function highlightSearchTerm(element, term) {
    const regex = new RegExp(`(${term})`, 'gi');
    const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null);
    
    let node;
    const nodesToReplace = [];
    while (node = walker.nextNode()) {
        if (regex.test(node.textContent)) {
            nodesToReplace.push(node);
        }
    }
    
    nodesToReplace.forEach(node => {
        const fragment = document.createDocumentFragment();
        const parts = node.textContent.split(regex);
        const matches = node.textContent.match(regex) || [];
        
        parts.forEach((part, index) => {
            if (index % 2 === 0) {
                fragment.appendChild(document.createTextNode(part));
            } else {
                const span = document.createElement('span');
                span.className = 'search-highlight';
                span.style.backgroundColor = 'yellow';
                span.textContent = part;
                fragment.appendChild(span);
            }
        });
        
        node.parentNode.replaceChild(fragment, node);
    });
}

// Mobile Sidebar Toggle
function handleToggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');
    sidebar.classList.toggle('show');
    mainContent.classList.toggle('expanded');
}

// Notification Handling
function toggleNotifications(e) {
    e.stopPropagation();
    const dropdown = document.getElementById('notificationsDropdown');
    if (dropdown) {
        dropdown.classList.toggle('show');
    }
}

function handleOutsideClick(e) {
    const dropdown = document.getElementById('notificationsDropdown');
    const bell = document.getElementById('notificationBell');
    if (dropdown && !dropdown.contains(e.target) && !bell.contains(e.target)) {
        dropdown.classList.remove('show');
    }
}

// Filter Functions
function setupFilterHandlers() {
    const doctorSearch = document.getElementById('doctorSearch');
    const doctorStatus = document.getElementById('doctorStatus');
    const patientSearch = document.getElementById('patientSearch');
    const patientStatus = document.getElementById('patientStatus');
    const appointmentSearch = document.getElementById('appointmentSearch');
    const prescriptionSearch = document.getElementById('prescriptionSearch');

    if (doctorSearch) doctorSearch.addEventListener('input', debounce(filterDoctors, 300));
    if (doctorStatus) doctorStatus.addEventListener('change', filterDoctors);
    if (patientSearch) patientSearch.addEventListener('input', debounce(filterPatients, 300));
    if (patientStatus) patientStatus.addEventListener('change', filterPatients);
    if (appointmentSearch) appointmentSearch.addEventListener('input', debounce(filterAppointments, 300));
    if (prescriptionSearch) prescriptionSearch.addEventListener('input', debounce(filterPrescriptions, 300));
}

function filterDoctors() {
    const search = document.getElementById('doctorSearch')?.value.toLowerCase() || '';
    const status = document.getElementById('doctorStatus')?.value || 'All';
    
    let filteredDoctors = mockData.doctors.filter(doc => {
        let matches = true;
        if (search) {
            matches = matches && (doc.name.toLowerCase().includes(search) || doc.specialty.toLowerCase().includes(search));
        }
        if (status !== 'All') {
            matches = matches && (doc.status === status);
        }
        return matches;
    });
    
    updateDoctorsTable(filteredDoctors);
}

function filterPatients() {
    const search = document.getElementById('patientSearch')?.value.toLowerCase() || '';
    const status = document.getElementById('patientStatus')?.value || 'All';
    const dateFrom = document.getElementById('patientDateFrom')?.value || '';
    const dateTo = document.getElementById('patientDateTo')?.value || '';
    
    let filteredPatients = mockData.patients.filter(patient => {
        let matches = true;
        if (search) {
            matches = matches && (patient.name.toLowerCase().includes(search) || patient.condition.toLowerCase().includes(search));
        }
        if (status !== 'All') {
            matches = matches && (patient.status === status);
        }
        if (dateFrom && dateTo) {
            matches = matches && (patient.lastVisit >= dateFrom && patient.lastVisit <= dateTo);
        }
        return matches;
    });
    
    updatePatientsTable(filteredPatients);
}

function filterAppointments() {
    const search = document.getElementById('appointmentSearch')?.value.toLowerCase() || '';
    const dateFrom = document.getElementById('appointmentDateFrom')?.value || '';
    const dateTo = document.getElementById('appointmentDateTo')?.value || '';
    
    let filteredAppointments = mockData.appointments.filter(apt => {
        let matches = true;
        if (search) {
            matches = matches && (apt.patient.toLowerCase().includes(search) || apt.doctor.toLowerCase().includes(search));
        }
        if (dateFrom && dateTo) {
            matches = matches && (apt.date >= dateFrom && apt.date <= dateTo);
        }
        return matches;
    });
    
    updateAppointmentsTable(filteredAppointments);
}

function filterPrescriptions() {
    const search = document.getElementById('prescriptionSearch')?.value.toLowerCase() || '';
    
    let filteredPrescriptions = mockData.prescriptions.filter(pres => {
        let matches = true;
        if (search) {
            matches = matches && (pres.patient.toLowerCase().includes(search) || pres.medication.toLowerCase().includes(search));
        }
        return matches;
    });
    
    updatePrescriptionsTable(filteredPrescriptions);
}

// Update table functions for filtered data
function updateDoctorsTable(doctors) {
    const tbody = document.getElementById('doctorsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    doctors.forEach(doctor => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${doctor.name}</td>
            <td>${doctor.specialty}</td>
            <td><span class="badge bg-${doctor.status === 'Active' ? 'success' : 'secondary'}">${doctor.status}</span></td>
            <td>${doctor.patients}</td>
            <td>${doctor.experience}</td>
            <td>
                <div>${doctor.contact}</div>
                <small class="text-muted">${doctor.phone}</small>
            </td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editDoctor(${doctor.id})">Edit</button>
                <button class="btn btn-sm btn-info me-1" onclick="viewDoctorSchedule(${doctor.id})">Schedule</button>
                <button class="btn btn-sm btn-danger" onclick="deleteDoctor(${doctor.id})">Delete</button>
            </td>
        `;
    });
}

function updatePatientsTable(patients) {
    const tbody = document.getElementById('patientsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    patients.forEach(patient => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${patient.name}</td>
            <td>${patient.ageGender}</td>
            <td><span class="badge bg-${patient.status === 'Active' ? 'success' : 'secondary'}">${patient.status}</span></td>
            <td>${patient.lastVisit}</td>
            <td>${patient.condition}</td>
            <td>${patient.doctor}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editPatient(${patient.id})">Edit</button>
                <button class="btn btn-sm btn-info me-1" onclick="viewPatientHistory(${patient.id})">History</button>
                <button class="btn btn-sm btn-danger" onclick="deletePatient(${patient.id})">Delete</button>
            </td>
        `;
    });
}

function updateAppointmentsTable(appointments) {
    const tbody = document.getElementById('appointmentsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    appointments.forEach(apt => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${apt.patient}</td>
            <td>${apt.doctor}</td>
            <td>${apt.date}</td>
            <td>${apt.time}</td>
            <td>${apt.duration}</td>
            <td>${apt.type}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editAppointment(${apt.id})">Edit</button>
                <button class="btn btn-sm btn-success me-1" onclick="confirmAppointment(${apt.id})">Confirm</button>
                <button class="btn btn-sm btn-danger" onclick="cancelAppointment(${apt.id})">Cancel</button>
            </td>
        `;
    });
}

function updatePrescriptionsTable(prescriptions) {
    const tbody = document.getElementById('prescriptionsTable');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    prescriptions.forEach(prescription => {
        const row = tbody.insertRow();
        row.innerHTML = `
            <td>${prescription.patient}</td>
            <td>${prescription.medication}</td>
            <td>${prescription.dosage}</td>
            <td>${prescription.frequency}</td>
            <td>${prescription.start}</td>
            <td>${prescription.end}</td>
            <td><span class="badge bg-success">${prescription.status}</span></td>
            <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editPrescription(${prescription.id})">Edit</button>
                <button class="btn btn-sm btn-info me-1" onclick="renewPrescription(${prescription.id})">Renew</button>
                <button class="btn btn-sm btn-secondary" onclick="printPrescription(${prescription.id})">Print</button>
            </td>
        `;
    });
}

// Multi-step Modal Functions
function setupDoctorModal() {
    const nextBtn = document.getElementById('nextStep');
    const prevBtn = document.getElementById('prevStep');
    const saveBtn = document.getElementById('saveDoctor');
    
    if (nextBtn) {
        nextBtn.addEventListener('click', () => {
            if (currentStep < 3) {
                hideStep(currentStep);
                currentStep++;
                showStep(currentStep);
                updateStepperDoctor();
                updateDoctorModalButtons();
            }
        });
    }
    
    if (prevBtn) {
        prevBtn.addEventListener('click', () => {
            if (currentStep > 1) {
                hideStep(currentStep);
                currentStep--;
                showStep(currentStep);
                updateStepperDoctor();
                updateDoctorModalButtons();
            }
        });
    }
    
    if (saveBtn) {
        saveBtn.addEventListener('click', saveDoctor);
    }
}

function setupPatientModal() {
    const nextBtn = document.getElementById('patientNext');
    const prevBtn = document.getElementById('patientPrev');
    const saveBtn = document.getElementById('savePatient');
    
    if (nextBtn) {
        nextBtn.addEventListener('click', () => {
            if (currentPatientStep < 2) {
                hidePatientStep(currentPatientStep);
                currentPatientStep++;
                showPatientStep(currentPatientStep);
                updateStepperPatient();
                updatePatientModalButtons();
            }
        });
    }
    
    if (prevBtn) {
        prevBtn.addEventListener('click', () => {
            if (currentPatientStep > 1) {
                hidePatientStep(currentPatientStep);
                currentPatientStep--;
                showPatientStep(currentPatientStep);
                updateStepperPatient();
                updatePatientModalButtons();
            }
        });
    }
    
    if (saveBtn) {
        saveBtn.addEventListener('click', savePatient);
    }
}

function hideStep(step) {
    const stepElement = document.querySelector(`#addDoctorModal .step-content[data-step="${step}"]`);
    if (stepElement) {
        stepElement.classList.add('hidden');
    }
}

function showStep(step) {
    const stepElement = document.querySelector(`#addDoctorModal .step-content[data-step="${step}"]`);
    if (stepElement) {
        stepElement.classList.remove('hidden');
    }
}

function hidePatientStep(step) {
    const stepElement = document.querySelector(`#addPatientModal .step-content[data-step="${step}"]`);
    if (stepElement) {
        stepElement.classList.add('hidden');
    }
}

function showPatientStep(step) {
    const stepElement = document.querySelector(`#addPatientModal .step-content[data-step="${step}"]`);
    if (stepElement) {
        stepElement.classList.remove('hidden');
    }
}

function updateStepperDoctor() {
    const steps = document.querySelectorAll('#doctorStepper .step');
    steps.forEach((step, index) => {
        const stepNum = index + 1;
        step.classList.remove('active', 'completed');
        if (stepNum < currentStep) {
            step.classList.add('completed');
        } else if (stepNum === currentStep) {
            step.classList.add('active');
        }
    });
}

function updateStepperPatient() {
    const steps = document.querySelectorAll('#addPatientModal .step');
    steps.forEach((step, index) => {
        const stepNum = index + 1;
        step.classList.remove('active', 'completed');
        if (stepNum < currentPatientStep) {
            step.classList.add('completed');
        } else if (stepNum === currentPatientStep) {
            step.classList.add('active');
        }
    });
}

function updateDoctorModalButtons() {
    const nextBtn = document.getElementById('nextStep');
    const prevBtn = document.getElementById('prevStep');
    const saveBtn = document.getElementById('saveDoctor');
    
    if (prevBtn) prevBtn.style.display = currentStep === 1 ? 'none' : 'inline-block';
    if (nextBtn) nextBtn.style.display = currentStep === 3 ? 'none' : 'inline-block';
    if (saveBtn) saveBtn.style.display = currentStep === 3 ? 'inline-block' : 'none';
}

function updatePatientModalButtons() {
    const nextBtn = document.getElementById('patientNext');
    const prevBtn = document.getElementById('patientPrev');
    const saveBtn = document.getElementById('savePatient');
    
    if (prevBtn) prevBtn.style.display = currentPatientStep === 1 ? 'none' : 'inline-block';
    if (nextBtn) nextBtn.style.display = currentPatientStep === 2 ? 'none' : 'inline-block';
    if (saveBtn) saveBtn.style.display = currentPatientStep === 2 ? 'inline-block' : 'none';
}

// Form Handlers
function setupFormHandlers() {
    // Profile form submission
    const profileForm = document.getElementById('profileForm');
    if (profileForm) {
        profileForm.addEventListener('submit', (e) => {
            e.preventDefault();
            saveEditProfile();
        });
    }

    // Reset modal states when modals are closed
    document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('hidden.bs.modal', function () {
            const form = this.querySelector('form');
            if (form) form.reset();
            
            // Reset multi-step modals
            if (this.id === 'addDoctorModal') {
                currentStep = 1;
                hideStep(2);
                hideStep(3);
                showStep(1);
                updateStepperDoctor();
                updateDoctorModalButtons();
            }
            
            if (this.id === 'addPatientModal') {
                currentPatientStep = 1;
                hidePatientStep(2);
                showPatientStep(1);
                updateStepperPatient();
                updatePatientModalButtons();
            }
        });
    });
}

// CRUD Operations and Actions
function saveDoctor() {
    const form = document.getElementById('addDoctorForm');
    const formData = new FormData(form);
    
    // In a real application, this would send data to the server
    console.log('Saving doctor:', Object.fromEntries(formData));
    showAlert('Doctor added successfully!', 'success');
    
    // Close modal and refresh table
    const modal = bootstrap.Modal.getInstance(document.getElementById('addDoctorModal'));
    modal.hide();
    populateDoctorsTable();
}

function savePatient() {
    const form = document.getElementById('addPatientForm');
    const formData = new FormData(form);
    
    console.log('Saving patient:', Object.fromEntries(formData));
    showAlert('Patient added successfully!', 'success');
    
    const modal = bootstrap.Modal.getInstance(document.getElementById('addPatientModal'));
    modal.hide();
    populatePatientsTable();
}

function saveAppointment() {
    const form = document.getElementById('scheduleForm');
    const formData = new FormData(form);
    
    console.log('Saving appointment:', Object.fromEntries(formData));
    showAlert('Appointment saved successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('scheduleAppointmentModal'));
    modal.hide();
    populateAppointmentsTable();
}

function savePrescription() {
    const form = document.getElementById('prescriptionForm');
    const formData = new FormData(form);
    
    console.log('Saving prescription:', Object.fromEntries(formData));
    showAlert('Prescription saved successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('addPrescriptionModal'));
    modal.hide();
    populatePrescriptionsTable();
}

function savePharmacyItem() {
    const form = document.getElementById('pharmacyForm');
    const formData = new FormData(form);
    
    console.log('Saving pharmacy item:', Object.fromEntries(formData));
    showAlert('Pharmacy item added successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('addPharmacyItemModal'));
    modal.hide();
    populatePharmacyTable();
}

function saveBloodEntry() {
    const form = document.getElementById('bloodForm');
    const formData = new FormData(form);
    
    console.log('Saving blood entry:', Object.fromEntries(formData));
    showAlert('Blood entry added successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('addBloodEntryModal'));
    modal.hide();
    populateBloodBankTable();
}

function saveInventoryItem() {
    const form = document.getElementById('inventoryForm');
    const formData = new FormData(form);
    
    console.log('Saving inventory item:', Object.fromEntries(formData));
    showAlert('Inventory item added successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('addInventoryItemModal'));
    modal.hide();
    populateInventoryTable();
}

function saveStaff() {
    const form = document.getElementById('staffForm');
    const formData = new FormData(form);
    
    console.log('Saving staff:', Object.fromEntries(formData));
    showAlert('Staff added successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('addStaffModal'));
    modal.hide();
    populateStaffTable();
}

function saveSession() {
    const form = document.getElementById('sessionForm');
    const formData = new FormData(form);
    
    console.log('Scheduling session:', Object.fromEntries(formData));
    showAlert('Session scheduled successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('scheduleSessionModal'));
    modal.hide();
}

function saveDepartment() {
    const form = document.getElementById('departmentForm');
    const formData = new FormData(form);
    
    console.log('Saving department:', Object.fromEntries(formData));
    showAlert('Department added successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('addDepartmentModal'));
    modal.hide();
    populateDepartmentsTable();
}

function saveInvoice() {
    const form = document.getElementById('invoiceForm');
    const formData = new FormData(form);
    
    console.log('Saving invoice:', Object.fromEntries(formData));
    showAlert('Invoice created successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('newInvoiceModal'));
    modal.hide();
    populateBillingTable();
}

function saveAmbulanceRequest() {
    const form = document.getElementById('ambulanceForm');
    const formData = new FormData(form);
    
    console.log('Saving ambulance request:', Object.fromEntries(formData));
    showAlert('Ambulance request saved successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('newAmbulanceModal'));
    modal.hide();
    populateAmbulanceTable();
}

function saveEditProfile() {
    const form = document.getElementById('editProfileForm');
    const formData = new FormData(form);
    
    console.log('Saving profile:', Object.fromEntries(formData));
    showAlert('Profile updated successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('editProfileModal'));
    modal.hide();
    
    // Update profile display
    const profileName = document.getElementById('profileName');
    const profileEmail = document.getElementById('profileEmail');
    const profileRole = document.getElementById('profileRole');
    
    if (profileName) profileName.innerHTML = `<strong>Name:</strong> ${formData.get('name')}`;
    if (profileEmail) profileEmail.innerHTML = `<strong>Email:</strong> ${formData.get('email')}`;
    if (profileRole) profileRole.innerHTML = `<strong>Role:</strong> ${formData.get('role')}`;
}

function uploadDocument() {
    const form = document.getElementById('documentForm');
    const formData = new FormData(form);
    
    console.log('Uploading document:', Object.fromEntries(formData));
    showAlert('Document uploaded successfully!', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('uploadDocumentModal'));
    modal.hide();
    populateDocumentsTable();
}

function simulateOCR() {
    const ocrResult = document.getElementById('ocrResult');
    if (ocrResult) {
        ocrResult.classList.remove('hidden');
        const textarea = ocrResult.querySelector('textarea');
        textarea.value = 'Simulated OCR Result:\nPatient Name: John Smith\nDiagnosis: Hypertension\nDate: 2025-09-10';
        showAlert('OCR simulation completed!', 'success');
    }
}

// Action Functions
function editDoctor(id) {
    const doctor = mockData.doctors.find(d => d.id === id);
    if (doctor) {
        showAlert(`Editing doctor: ${doctor.name}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('addDoctorModal'));
        // Populate form with doctor data (implementation depends on requirements)
        modal.show();
    }
}

function viewDoctorSchedule(id) {
    showAlert(`Viewing schedule for doctor ID: ${id}`, 'info');
}

function deleteDoctor(id) {
    if (confirm('Are you sure you want to delete this doctor?')) {
        mockData.doctors = mockData.doctors.filter(d => d.id !== id);
        showAlert(`Doctor with ID ${id} deleted successfully`, 'success');
        populateDoctorsTable();
    }
}

function editPatient(id) {
    const patient = mockData.patients.find(p => p.id === id);
    if (patient) {
        showAlert(`Editing patient: ${patient.name}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('addPatientModal'));
        // Populate form with patient data (implementation depends on requirements)
        modal.show();
    }
}

function viewPatientHistory(id) {
    showAlert(`Viewing history for patient ID: ${id}`, 'info');
}

function deletePatient(id) {
    if (confirm('Are you sure you want to delete this patient?')) {
        mockData.patients = mockData.patients.filter(p => p.id !== id);
        showAlert(`Patient with ID ${id} deleted successfully`, 'success');
        populatePatientsTable();
    }
}

function editAppointment(id) {
    const appointment = mockData.appointments.find(a => a.id === id);
    if (appointment) {
        showAlert(`Editing appointment for ${appointment.patient}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('scheduleAppointmentModal'));
        // Populate form with appointment data (implementation depends on requirements)
        modal.show();
    }
}

function confirmAppointment(id) {
    const appointment = mockData.appointments.find(a => a.id === id);
    if (appointment) {
        appointment.status = 'Confirmed';
        showAlert(`Appointment with ID ${id} confirmed`, 'success');
        populateAppointmentsTable();
    }
}

function cancelAppointment(id) {
    if (confirm('Are you sure you want to cancel this appointment?')) {
        mockData.appointments = mockData.appointments.filter(a => a.id !== id);
        showAlert(`Appointment with ID ${id} cancelled`, 'warning');
        populateAppointmentsTable();
    }
}

function editPrescription(id) {
    const prescription = mockData.prescriptions.find(p => p.id === id);
    if (prescription) {
        showAlert(`Editing prescription for ${prescription.patient}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('addPrescriptionModal'));
        // Populate form with prescription data (implementation depends on requirements)
        modal.show();
    }
}

function renewPrescription(id) {
    const prescription = mockData.prescriptions.find(p => p.id === id);
    if (prescription) {
        prescription.end = new Date(new Date(prescription.end).setMonth(new Date(prescription.end).getMonth() + 3)).toISOString().split('T')[0];
        showAlert(`Prescription with ID ${id} renewed`, 'success');
        populatePrescriptionsTable();
    }
}

function printPrescription(id) {
    showAlert(`Printing prescription with ID: ${id}`, 'info');
}

function trackAmbulance(id) {
    showAlert(`Tracking ambulance ${id}`, 'info');
}

function updateAmbulanceStatus(id) {
    const request = mockData.ambulance.find(a => a.id === id);
    if (request) {
        const statuses = ['Dispatched', 'En Route', 'Arrived', 'Completed'];
        const currentIndex = statuses.indexOf(request.status);
        request.status = statuses[(currentIndex + 1) % statuses.length];
        showAlert(`Ambulance ${id} status updated to ${request.status}`, 'info');
        populateAmbulanceTable();
    }
}

function cancelAmbulanceRequest(id) {
    if (confirm('Are you sure you want to cancel this ambulance request?')) {
        mockData.ambulance = mockData.ambulance.filter(a => a.id !== id);
        showAlert(`Ambulance request ${id} cancelled`, 'warning');
        populateAmbulanceTable();
    }
}

function editPharmacyItem(id) {
    const item = mockData.pharmacy.find(p => p.id === id);
    if (item) {
        showAlert(`Editing pharmacy item: ${item.medication}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('addPharmacyItemModal'));
        // Populate form with item data (implementation depends on requirements)
        modal.show();
    }
}

function restockItem(id) {
    const item = mockData.pharmacy.find(p => p.id === id);
    if (item) {
        item.stock += 100;
        showAlert(`Restocking item: ${item.medication}`, 'success');
        populatePharmacyTable();
    }
}

function editBloodEntry(id) {
    const entry = mockData.bloodBank.find(b => b.id === id);
    if (entry) {
        showAlert(`Editing blood entry: ${entry.type}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('addBloodEntryModal'));
        // Populate form with entry data (implementation depends on requirements)
        modal.show();
    }
}

function useBlood(id) {
    if (confirm('Are you sure you want to use this blood unit?')) {
        const entry = mockData.bloodBank.find(b => b.id === id);
        if (entry) {
            entry.quantity--;
            if (entry.quantity <= 0) {
                mockData.bloodBank = mockData.bloodBank.filter(b => b.id !== id);
            }
            showAlert(`Blood unit with ID ${id} used`, 'success');
            populateBloodBankTable();
        }
    }
}

function viewBloodDetails(id) {
    showAlert(`Viewing details for blood entry ID: ${id}`, 'info');
}

function markPaid(id) {
    const invoice = mockData.billing.find(inv => inv.id === id);
    if (invoice) {
        invoice.status = 'Paid';
        showAlert('Invoice marked as paid!', 'success');
        populateBillingTable();
    }
}

function viewInvoice(id) {
    showAlert(`Viewing invoice ${id}`, 'info');
}

function printInvoice(id) {
    showAlert(`Printing invoice ${id}`, 'info');
}

function editDepartment(id) {
    const dept = mockData.departments.find(d => d.id === id);
    if (dept) {
        showAlert(`Editing department: ${dept.department}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('addDepartmentModal'));
        // Populate form with department data (implementation depends on requirements)
        modal.show();
    }
}

function manageDepartmentStaff(id) {
    showAlert(`Managing staff for department ID: ${id}`, 'info');
}

function manageBudget(id) {
    showAlert(`Managing budget for department ID: ${id}`, 'info');
}

function editInventoryItem(id) {
    const item = mockData.inventory.find(i => i.id === id);
    if (item) {
        showAlert(`Editing inventory item: ${item.item}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('addInventoryItemModal'));
        // Populate form with item data (implementation depends on requirements)
        modal.show();
    }
}

function orderItem(id) {
    const item = mockData.inventory.find(i => i.id === id);
    if (item) {
        item.quantity += 100;
        showAlert(`Ordering item: ${item.item}`, 'success');
        populateInventoryTable();
    }
}

function editStaff(id) {
    const staff = mockData.staff.find(s => s.id === id);
    if (staff) {
        showAlert(`Editing staff: ${staff.name}`, 'info');
        const modal = new bootstrap.Modal(document.getElementById('addStaffModal'));
        // Populate form with staff data (implementation depends on requirements)
        modal.show();
    }
}

function viewStaffSchedule(id) {
    showAlert(`Viewing schedule for staff ID: ${id}`, 'info');
}

function deleteStaff(id) {
    if (confirm('Are you sure you want to delete this staff member?')) {
        mockData.staff = mockData.staff.filter(s => s.id !== id);
        showAlert(`Staff with ID ${id} deleted successfully`, 'success');
        populateStaffTable();
    }
}

function viewDocument(id) {
    showAlert(`Viewing document with ID: ${id}`, 'info');
}

function downloadDocument(id) {
    showAlert(`Downloading document with ID: ${id}`, 'info');
}

function shareDocument(id) {
    showAlert(`Sharing document with ID: ${id}`, 'info');
}

function downloadReport(id) {
    showAlert(`Downloading report with ID: ${id}`, 'success');
}

function viewReportStatus(id) {
    showAlert(`Viewing status for report ID: ${id}`, 'info');
}

function markMedicationTaken(button) {
    button.textContent = 'Taken';
    button.classList.remove('btn-outline-primary');
    button.classList.add('btn-success');
    button.disabled = true;
    showAlert('Medication marked as taken', 'success');
}

function markNotificationRead(id) {
    const notification = mockData.notifications.find(n => n.id === id);
    if (notification) {
        notification.read = true;
        populateNotifications();
        showAlert('Notification marked as read', 'success');
    }
}

// Charts and Analytics
function initializeCharts() {
    initializeVisitsChart();
    initializeAnalyticsChart();
}

function initializeVisitsChart() {
    const ctx = document.getElementById('visitsChart');
    if (!ctx) return;
    
    const chartData = {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: [{
            label: 'Patient Visits',
            data: [45, 52, 38, 65, 59, 42, 35],
            borderColor: 'rgb(75, 192, 192)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            tension: 0.1
        }]
    };
    
    charts.visitsChart = new Chart(ctx, {
        type: 'line',
        data: chartData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

function initializeAnalyticsChart() {
    const ctx = document.getElementById('analyticsChart');
    if (!ctx) return;
    
    charts.analyticsChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [],
            datasets: []
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                }
            }
        }
    });
}

function generateReport() {
    const reportType = document.getElementById('reportType')?.value;
    const startDate = document.getElementById('reportStart')?.value;
    const endDate = document.getElementById('reportEnd')?.value;
    
    showAlert(`Generating ${reportType} report from ${startDate} to ${endDate}`, 'info');
    
    // Simulate report generation
    setTimeout(() => {
        const newReport = {
            id: mockData.reports.length + 1,
            report: `${reportType} - ${new Date().toLocaleDateString()}`,
            date: new Date().toISOString().split('T')[0],
            status: 'Generated',
            type: 'Custom'
        };
        mockData.reports.push(newReport);
        populateReportsTable();
        showAlert('Report generated successfully!', 'success');
    }, 1000);
}

function generateAnalyticsReport() {
    const reportType = document.getElementById('analyticsReportType')?.value;
    const startDate = document.getElementById('analyticsStart')?.value;
    const endDate = document.getElementById('analyticsEnd')?.value;
    
    showAlert(`Generating ${reportType} analytics report from ${startDate} to ${endDate}`, 'info');
    
    // Sample data for analytics chart
    const chartData = {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
        datasets: [{
            label: reportType,
            data: [Math.random() * 100, Math.random() * 100, Math.random() * 100, Math.random() * 100, Math.random() * 100, Math.random() * 100],
            backgroundColor: 'rgba(75, 192, 192, 0.5)',
            borderColor: 'rgb(75, 192, 192)',
            borderWidth: 1
        }]
    };
    
    if (charts.analyticsChart) {
        charts.analyticsChart.data = chartData;
        charts.analyticsChart.update();
    }
    
    setTimeout(() => {
        showAlert('Analytics report generated successfully!', 'success');
    }, 1000);
}

// Real-time Features
function setupRealTimeFeatures() {
    // Simulate real-time notifications
    setInterval(() => {
        const newNotification = {
            id: mockData.notifications.length + 1,
            message: `New system alert: ${new Date().toLocaleTimeString()}`,
            time: 'Just now',
            read: false,
            priority: 'normal'
        };
        mockData.notifications.unshift(newNotification);
        populateNotifications();
    }, 60000); // Every minute
}

// Window Resize Handler
function handleWindowResize() {
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');
    
    if (window.innerWidth > 768) {
        sidebar.classList.remove('show');
        mainContent.classList.remove('expanded');
    }
}

// Keyboard Shortcuts
function handleKeyboardShortcuts(e) {
    if (e.ctrlKey && e.key === '/') {
        const search = document.getElementById('globalSearch');
        if (search) search.focus();
    }
    if (e.ctrlKey && e.key === 'n') {
        e.preventDefault();
        const modal = new bootstrap.Modal(document.getElementById('scheduleAppointmentModal'));
        modal.show();
    }
}
</script>
</body>
</html>